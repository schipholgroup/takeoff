stages:
- test
- deploy

services:
- docker:dind

lint:
  image: python:3.7
  stage: test
  script:
  - python setup.py flake8

test:
  image: python:3.7
  stage: test
  script:
  - python setup.py test

runway:
  image: docker:stable
  stage: deploy
  script:
  - export DOCKER_HOST="tcp://localhost:2375"
  - docker build -t runway:latest -f Dockerfile_python .
  - docker login --username $jfrog_username --password $jfrog_password schipholsdh-docker.jfrog.io
  - docker run runway:latest runway
